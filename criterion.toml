# Criterion.rs Benchmark Configuration
# This file configures the behavior of Criterion.rs benchmarks

# CLI Colors
# Supported values: [auto, always, never]
colors = "auto"

# Print output in a quieter format. This is useful in CI environments.
quiet = false

# Measure throughput (in items/s) instead of time. This requires the
# --sample-size and --measurement-time options to be specified explicitly.
# The value must be one of:
# - "Now" (for benchmarking the current time)
# - A string like "Bytes" or "Elements" to measure throughput in bytes/s or elements/s
# throughput = "Bytes"

# Benchmark significance level
# Must be between 0.0 and 1.0 (exclusive)
alpha = 0.05

# The desired measurement noise threshold. If the noise level is greater than this,
# Criterion will print a warning.
noise_threshold = 0.02

# The desired confidence interval width
confidence_level = 0.95

# The number of samples to collect in each benchmark.
# More samples means more accurate results, but longer benchmarking time.
sample_size = 100

# The number of warm-up runs to perform before measuring.
# Warm-up runs allow the CPU to optimize the code being measured.
warm_up_time = 3.0  # seconds

# The time to measure each benchmark for, in seconds.
# More time means more samples and more accurate results.
measurement_time = 5.0  # seconds

# The number of resamples to perform when bootstrapping the data.
# More resamples means more accurate confidence intervals.
nresamples = 100_000

# List of benchmarks to skip
# skip = []

# Plot configuration
plotting = {
  # Plotting backend to use. Options: "gnuplot", "plotters", or null to disable.
  # Note: gnuplot must be installed on the system to use it.
  plot_config = null

  # Summary plot configuration
  summary_scale = "logarithmic"  # Options: "linear", "logarithmic"

  # Comparison plot configuration
  comparison_scale = "logarithmic"

  # Enable/disable the relative plot
  relative_densities = true

  # Enable/disable the absolute plot
  absolute_densities = true
}

# Output format
output_format = "quiet"  # Options: "quiet", "verbose", "pretty"

# Baseline configuration
# Baselines are used for comparing performance across commits
baseline = "main"  # Default baseline name

# Comparison configuration
# Comparison allows comparing different baselines
comparison = """
# Comparison configuration
compare = """
  # Baselines to compare against
  baseline = "main"

  # Only show benchmarks where the new version is significantly different
  only_changed = false

  # Threshold for significance (as a percentage)
  significance_level = 0.05

  # Noise threshold
  noise_threshold = 0.02

  # Confidence interval
  confidence_level = 0.95
"""

# Quick benchmark configuration for CI
[ci]
# Reduced settings for faster CI runs
sample_size = 10
warm_up_time = 1.0
measurement_time = 3.0
nresamples = 10_000
quiet = true

# Full benchmark configuration for local runs and main branch
[full]
# Full settings for accurate results
sample_size = 100
warm_up_time = 5.0
measurement_time = 60.0
nresamples = 100_000
quiet = false

# Memory benchmark configuration
[memory]
sample_size = 50
warm_up_time = 2.0
measurement_time = 10.0

# JIT benchmark configuration
[jit]
sample_size = 30
warm_up_time = 3.0
measurement_time = 15.0

# Async benchmark configuration
[async]
sample_size = 50
warm_up_time = 2.0
measurement_time = 10.0

# TLB benchmark configuration
[tlb]
sample_size = 100
warm_up_time = 1.0
measurement_time = 5.0

# Performance regression detection settings
[regression]
# Threshold for detecting performance regressions (percentage)
# Default: 10% regression will trigger a warning
threshold = 10.0

# Minimum improvement to be considered significant (percentage)
improvement_threshold = 5.0

# Whether to fail the benchmark if regression is detected
fail_on_regression = false

# Whether to warn if regression is detected
warn_on_regression = true
