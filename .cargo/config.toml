[net]
git-fetch-with-cli = true

[http]
check-revoke = false

# ============================================================================
# 构建优化配置
# ============================================================================
[build]
# 使用更多并行任务来加速构建
jobs = 4

# 增量编译
# 使用packed调试信息减少磁盘占用和编译时间
[profile.dev]
split-debuginfo = "packed"
# 启用增量编译
incremental = true

[profile.test]
split-debuginfo = "packed"
incremental = true

[profile.bench]
split-debuginfo = "packed"
# 基准测试通常不需要增量编译
incremental = false

# ============================================================================
# 其他优化配置
# ============================================================================
[term]
verbose = false
color = "auto"

[alias]
# 便捷的构建别名
b = "build --workspace"
t = "test --workspace"
c = "check --workspace"
# 清理所有构建产物
clean-all = ["clean", "-p", "vm-*", "perf-bench"]
# 运行所有检查
check-all = ["check", "--workspace", "--all-targets", "--all-features"]
# 生成hakari依赖
hakari-gen = "hakari generate"
# 验证hakari配置
hakari-verify = "hakari verify"

# ============================================================================
# ARM64特定优化 (Round 34-35)
# ============================================================================
[target.aarch64-apple-darwin]
# Apple M4/M4 Pro特定优化
rustflags = [
    # 优化目标CPU
    "-C", "target-cpu=apple-m4",
    # 启用NEON SIMD特性
    "-C", "target-feature=+neon",
    "-C", "target-feature=+crypto",    # AES/SHA硬件加速
    "-C", "target-feature=+aes",       # AES加密指令集
    "-C", "target-feature=+crc",       # CRC-32校验和计算
    "-C", "target-feature=+dotprod",   # 点积运算加速(ML重要)
    "-C", "target-feature=+fp16",      # 半精度浮点(AI/ML重要)
]

[target.aarch64-unknown-linux-gnu]
# 通用ARM64 Linux优化
rustflags = [
    "-C", "target-cpu=neoverse-v1",   # 使用Neoverse V1作为基线
    "-C", "target-feature=+neon",
    "-C", "target-feature=+crypto",
    "-C", "target-feature=+aes",
    "-C", "target-feature=+crc",
    "-C", "target-feature=+dotprod",
    "-C", "target-feature=+fp16",
    "-C", "target-feature=+lse",       # Large System Extension
    "-C", "target-feature=+rdm",       # Round Robin Multiplication
]
