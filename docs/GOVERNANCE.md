# VM项目治理文档

本文档定义了VM项目的治理结构、角色和职责、决策流程以及发布管理。

## 目录

- [项目结构](#项目结构)
- [角色和职责](#角色和职责)
- [决策流程](#决策流程)
- [发布流程](#发布流程)
- [路线图规划](#路线图规划)
- [社区管理](#社区管理)

## 项目结构

### 组织架构

```
┌─────────────────────────────────────┐
│         技术指导委员会 (TSC)          │
│      (Technical Steering Committee)  │
└─────────────────────────────────────┘
                 ↓
┌─────────────────────────────────────┐
│            项目维护者                │
│    (Maintainers / Committers)        │
└─────────────────────────────────────┘
                 ↓
┌─────────────────────────────────────┐
│           贡献者 (Contributors)       │
│    (Active Contributors)             │
└─────────────────────────────────────┘
                 ↓
┌─────────────────────────────────────┐
│          用户和关注者 (Users)         │
└─────────────────────────────────────┘
```

### 项目所有权

VM项目是社区驱动的开源项目，遵循以下原则：

- **开放性**：任何人都可以贡献
- **透明性**：决策过程公开透明
- **精英主义**：贡献决定影响力
- **社区优先**：社区利益优于个人或公司利益

## 角色和职责

### 技术指导委员会 (TSC)

#### 组成

TSC由核心维护者组成，初始成员包括项目创始人和主要贡献者。

#### 职责

- 制定项目技术方向和路线图
- 批准重大架构变更
- 解决技术争议
- 维护项目愿景
- 确保项目长期健康

#### 权力

- 批准/拒绝RFC（Request for Comments）
- 投票决定重大技术决策
- 任命新的维护者
- 修改治理文档（需2/3多数通过）

#### 会议

- **频率**：每月一次公开会议
- **形式**：在线视频会议
- **记录**：会议纪要公开存档
- **参与**：任何人都可以旁听并提出建议

### 项目维护者

#### 职责

- **代码审查**：审查和合并PR
- **Issue管理**：分类、优先级排序、分配
- **发布管理**：准备和发布版本
- **文档维护**：保持技术文档更新
- **社区支持**：回答问题、帮助新贡献者
- **质量保证**：确保代码质量和测试覆盖

#### 权利

- 直接推送到主分支（紧急情况）
- 审查和批准PR
- 分配和关闭issue
- 参与技术决策投票
- 提名新维护者

#### 要求

- 持续6个月以上的活跃贡献
- 提交至少20个有意义的PR
- 审查至少50个PR
- 通过现有维护者的投票（2/3多数通过）
- 遵守行为准则

#### 成为维护者的流程

1. **提名**：现有维护者提名或自荐
2. **审查**：TSC审查贡献历史
3. **投票**：维护者投票（2/3多数通过）
4. **公告**：在社区公告新维护者
5. **试用期**：3个月试用期
6. **确认**：试用期结束后正式确认

### 贡献者等级

#### 一级贡献者 (Contributor)

- 提交了至少1个合并的PR
- 参与讨论
- 报告bug或提出功能请求

#### 二级贡献者 (Active Contributor)

- 提交了至少5个合并的PR
- 活跃参与issue讨论
- 帮助审查其他人的PR
- 改进文档

#### 三级贡献者 (Senior Contributor)

- 持续6个月以上活跃贡献
- 提交了至少15个高质量的PR
- 在某个子系统有专业知识
- 指导新贡献者
- 可成为维护者候选人

## 决策流程

### 日常决策

#### 小型变更

- **定义**：bug修复、小功能、文档更新、重构
- **流程**：
  1. 创建PR
  2. 任一维护者审查通过
  3. CI检查通过
  4. 合并

- **审查时间**：通常3-5个工作日

#### 中型变更

- **定义**：新功能、API变更、重要重构
- **流程**：
  1. 提交RFC（如果涉及API变更）
  2. 社区讨论（至少7天）
  3. 创建PR
  4. 至少2位维护者批准
  5. CI检查通过
  6. 合并

- **审查时间**：1-2周

### 重大决策

#### 重大变更

- **定义**：架构重组、breaking changes、技术栈更换
- **流程**：
  1. **RFC阶段**：
     - 提交RFC文档
     - 社区讨论（至少14天）
     - TSC投票（2/3多数通过）

  2. **实施阶段**：
     - 创建跟踪issue
     - 实施计划批准
     - 分阶段实施

  3. **审查阶段**：
     - 每个阶段需要独立PR
     - 多次审查迭代
     - 文档同步更新

- **决策时间**：1-3个月

#### RFC流程

1. **提案**：创建RFC PR
   - 标题格式：`[RFC] RFC-XXX: 标题`
   - 包含：动机、详细设计、替代方案、影响分析

2. **讨论**：社区公开讨论
   - 期限：至少14天
   - 所有关键利益相关者参与

3. **修订**：根据反馈修订RFC
   - 可以多次迭代
   - 重大修订需要重新讨论

4. **投票**：TSC投票
   - 选项：批准 / 拒绝 / 延期
   - 需要2/3多数通过

5. **实施**：
   - RFC批准后实施
   - 更新RFC状态（接受/实施/完成）

### 决策原则

- **共识优先**：尽量达成共识
- **数据驱动**：基于数据和证据决策
- **向后兼容**：避免breaking changes
- **渐进增强**：支持渐进式迁移
- **文档先行**：重大变更需有文档支持

## 发布流程

### 版本策略

遵循[语义化版本](https://semver.org/lang/zh-CN/)：

- **主版本号（Major）**：不兼容的API变更
- **次版本号（Minor）**：向后兼容的新功能
- **修订号（Patch）**：向后兼容的bug修复

### 发布周期

#### 主版本（Major）

- **频率**：每6-12个月
- **内容**：重大新功能、breaking changes
- **支持期**：12个月

#### 次版本（Minor）

- **频率**：每2-3个月
- **内容**：新功能、增强
- **支持期**：与主版本一致

#### 修订版本（Patch）

- **频率**：根据需要（通常每月）
- **内容**：bug修复、安全更新
- **支持期**：与主版本一致

### 发布准备

#### 发布候选（RC）

在正式发布前，发布1-2个RC版本：

1. **冻结代码**：停止新功能
2. **修复bug**：只修复关键bug
3. **测试**：全面测试
4. **文档**：更新所有文档
5. **公告**：社区公告，鼓励测试

#### 发布检查清单

- [ ] 所有计划的功能已实现
- [ ] 所有已知严重bug已修复
- [ ] 测试覆盖率达标（85%+）
- [ ] 文档完整且更新
- [ ] CHANGELOG已更新
- [ ] 迁移指南已准备（如有breaking changes）
- [ ] 性能基准测试通过
- [ ] 安全审计通过（如果包含安全相关变更）
- [ ] 向后兼容性测试通过
- [ ] RC版本获得社区验证

### 发布流程

#### 发布前

1. **创建发布分支**：
   ```bash
   git checkout -b release/v0.3.0
   ```

2. **更新版本号**：
   ```bash
   # Cargo.toml
   [package]
   version = "0.3.0"
   ```

3. **更新CHANGELOG**：
   ```markdown
   ## [0.3.0] - 2025-01-15

   ### Added
   - RISC-V M扩展支持
   - JIT编译优化

   ### Fixed
   - 修复TLB刷新问题
   - 修复内存泄漏

   ### Changed
   - API breaking changes（见迁移指南）
   ```

4. **创建git tag**：
   ```bash
   git tag -a v0.3.0 -m "Release v0.3.0"
   ```

#### 发布中

5. **推送到GitHub**：
   ```bash
   git push upstream release/v0.3.0
   git push upstream v0.3.0
   ```

6. **创建GitHub Release**：
   - 使用CHANGELOG内容
   - 附上二进制下载链接
   - 提供升级说明

7. **发布到crates.io**：
   ```bash
   cargo publish
   ```

#### 发布后

8. **合并回主分支**：
   ```bash
   git checkout master
   git merge release/v0.3.0
   ```

9. **发布公告**：
   - GitHub Release
   - 项目博客
   - 邮件列表
   - 社交媒体

10. **更新文档网站**

### 紧急发布

对于关键安全漏洞或严重bug：

1. **创建hotfix分支**：
   ```bash
   git checkout -b hotfix/v0.2.1
   ```

2. **快速修复**：
   - 只修复关键问题
   - 最小化变更

3. **快速发布**：
   - 跳过RC阶段
   - 简化流程
   - 快速公告

## 路线图规划

### 规划周期

- **年度规划**：每年12月制定下一年度计划
- **季度规划**：每季度末调整优先级
- **月度回顾**：每月回顾进度

### 优先级判断

#### P0 - 紧急且重要

- 安全漏洞
- 数据丢失bug
- 系统崩溃
- 性能严重退化

#### P1 - 重要

- 核心功能缺失
- 用户体验严重受影响
- 大量用户请求

#### P2 - 中等

- 增强功能
- 优化用户体验
- 代码质量改进

#### P3 - 低优先级

- 锦上添花的功能
- 文档改进
- 技术债务清理

### 路线图制定流程

1. **收集需求**：
   - GitHub Issues
   - 社区反馈
   - 用户调研
   - 技术趋势

2. **评估和分类**：
   - 优先级排序
   - 工作量估算
   - 依赖关系分析

3. **公开讨论**：
   - 社区RFC
   - TSC讨论
   - 投票决策

4. **发布路线图**：
   - 公开发布
   - 定期更新
   - 进度追踪

### 当前路线图

#### 短期（1-3个月）

- [ ] 完成RISC-V M扩展实现（170+指令）
- [ ] 提升测试覆盖率到85%
- [ ] 优化JIT编译性能
- [ ] 修复已知P0/P1 bug

#### 中期（3-6个月）

- [ ] 完成RISC-V A/F/D/C扩展
- [ ] 实现ARM SMMU支持
- [ ] 模块依赖简化
- [ ] 完善文档和示例

#### 长期（6-12个月）

- [ ] 多JIT引擎优化
- [ ] 性能监控和分析工具
- [ ] 云原生支持
- [ ] 插件系统

## 社区管理

### 行为准则执行

- **报告机制**：安全渠道报告违规
- **调查流程**：维护者委员会调查
- **处罚措施**：警告 -> 暂时禁止 -> 永久禁止
- **申诉流程**：独立的申诉渠道

### 社区健康

#### 指标

- 活跃贡献者数量
- PR和issue处理时间
- 新贡献者留存率
- 社区满意度（定期调查）

#### 目标

- PR响应时间：平均<5天
- 新贡献者首PR响应时间：<3天
- 社区增长：每月新增2-3名活跃贡献者
- 代码审查覆盖率：100%

### 沟通渠道

- **GitHub**：主要协作平台
- **Discord/Slack**：实时沟通
- **邮件列表**：重要公告
- **博客**：技术文章和更新
- **会议**：定期社区会议

## 附录

### 修改治理文档

对本文档的修改需要：

1. TSC提案
2. 社区讨论（至少14天）
3. TSC投票（2/3多数通过）

### 联系方式

- **TSC邮箱**：tsc@example.com
- **安全问题**：security@example.com
- **一般问题**：GitHub Issues

### 文档版本

- **创建日期**：2024年12月
- **最后更新**：2024年12月31日
- **版本**：1.0.0
- **状态**：生效中

---

本文档是VM项目治理的基础，所有社区成员都应该了解并遵守。
