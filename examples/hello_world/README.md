# Hello World 示例

最简单的VM示例,展示如何创建虚拟机、加载程序并执行。

## 这个示例展示了

1. **创建VM配置** - 设置架构和内存大小
2. **内存管理** - 使用MMU管理虚拟内存
3. **程序加载** - 将机器码加载到VM内存
4. **指令执行** - 逐条执行RISC-V指令
5. **结果验证** - 读取寄存器并验证执行结果

## 运行示例

```bash
# 从项目根目录运行
cargo run --example hello_world

# 或者直接运行编译后的二进制文件
cd examples/hello_world
cargo run
```

## 预期输出

```
=== VM Hello World 示例 ===

步骤 1: 创建VM配置
✅ 配置创建成功
   架构: Riscv64
   内存大小: 1 MB

步骤 2: 创建内存管理单元(MMU)
✅ MMU创建成功
   代码区域: 0x1000 - 0x2000

步骤 3: 准备RISC-V程序
✅ 程序已加载到内存
   代码基地址: 0x1000
   程序大小: 16 字节

步骤 4: 创建指令集前端
✅ 前端创建成功

步骤 5: 创建执行引擎
✅ 执行引擎创建成功

步骤 6: 设置程序计数器(PC)
✅ PC = 0x1000

步骤 7: 执行程序
--- 开始执行 ---

执行第 1 条指令: PC = 0x1000
执行第 2 条指令: PC = 0x1004
执行第 3 条指令: PC = 0x1008
执行第 4 条指令: PC = 0x100c

✅ 程序执行完成
总执行指令数: 4

步骤 8: 检查执行结果
寄存器状态:
  x1 (a0) = 10
  x2 (a1) = 20
  x3 (a2) = 30 (x1 + x2的结果)

✅ 结果验证成功! 10 + 20 = 30

步骤 9: 执行统计
  总指令数: 4
  执行时间: 12.5µs

=== 示例完成 ===
```

## 程序说明

这个示例执行一个简单的RISC-V程序:

```assembly
li  x1, 10      # 将立即数10加载到寄存器x1
li  x2, 20      # 将立即数20加载到寄存器x2
add x3, x1, x2  # x3 = x1 + x2 (结果为30)
ret             # 返回
```

### 关键概念

- **VM配置**: 定义虚拟机的基本属性(架构、内存大小等)
- **MMU**: 内存管理单元,负责虚拟地址到物理地址的转换
- **前端**: 特定指令集的解码器和实现
- **执行引擎**: 协调内存、前端和JIT/解释器来执行指令

## 学习路径

完成这个示例后,你可以继续学习:

1. **Fibonacci示例** - 学习更复杂的程序和内存访问
2. **JIT执行示例** - 了解如何使用JIT编译提升性能
3. **自定义设备示例** - 学习如何添加外部设备

## 故障排除

### 编译错误

如果遇到编译错误,请确保:

```bash
# 更新依赖
cargo update

# 清理并重新构建
cargo clean
cargo build --example hello_world
```

### 运行时错误

如果遇到运行时错误,检查:

1. Rust版本是否满足要求 (需要Rust 1.85+)
2. 所有依赖crate是否正常编译
3. 日志输出中的错误信息

## 相关文档

- [RISC-V编程指南](../../docs/tutorials/RISCV_PROGRAMMING.md)
- [VM API文档](https://docs.rs/vm)
- [执行引擎详解](../../docs/tutorials/ADVANCED_USAGE.md)
